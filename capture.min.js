/*!
 * Capture 0.0.1
 * (c) 2013 Dan Roberts, Ogilvy & Mather Atlanta
 * Capture may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://eatarandom.github.com/capture/
 */
(function(){"use strict";function t(t){this.cid=l("ce"),h(this,h(a,t)),0>this.id&&(this.id=this.cid),this.initialize.call(this)}function i(){}function e(){this.initialize.apply(this,arguments)}function n(t){this.version=s,this.events=[],this.providers=[new e],t.config&&t.config.length&&(this.config=t.config),h(this,h(c,t)),this.initialize.call(this)}var r=this,o=r.Zepto||r.jQuery||r.$,s="0.0.1",c={debug:!1,delay:!1},a={selector:"body",action:"click",type:"track",props:{}},h=function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t},u=0,l=function(t){var i=++u+"";return t?t+i:i},p=Object.keys||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var i=[];for(var e in t)f(t,e)&&(i[i.length]=e);return i},f=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},v=function(t,i){for(var e=p(t),n=0,r=e.length;r>n;n++){var o=e[n];"function"==typeof t[o]&&(t[o]=t[o].call(i))}return t},g=function(){function t(){this.subjects={}}return h(t.prototype,{publish:function(t,i,e){var n=this.subjects;if(n.hasOwnProperty(t))for(var r=0,o=n[t].length;o>r;r++){var s=n[t][r];s.callback.call(e,i)}},subscribe:function(t,i){var e=this.subjects;e.hasOwnProperty(t)||(e[t]=[]),e[t].push({context:this,callback:i})}}),{evt:{track:"track",pageview:"pageview"},mediator:new t}}.call(r);h(t.prototype,h(g,{initialize:function(){var t=this;if(this.selector=o(this.selector),!this.selector||!this.selector.length)throw Error("CaptureEvent"+this.id+"needs a valid selector");"string"==typeof this.type&&(this.type=this.type.split()),this.selector.on(this.action,function(i){t.publish(i)})},publish:function(t){t.preventDefault();for(var i=0,e=this.type.length;e>i;i++)this.mediator.publish(this.type[i],v(this.props,t.target),this)}})),h(i.prototype,h(g,{initialize:function(){this.mediator.subscribe(this.evt.track,this.track),this.mediator.subscribe(this.evt.pageview,this.pageview)}})),h(e.prototype,h(i.prototype,{track:function(t){console.log("gaq track ",t)},pageview:function(t){console.log("gaq pageview ",t)}})),h(n.prototype,h(g,{initialize:function(){if(this.config&&this.config.length)for(var t=0,i=this.config.length;i>t;t++)this.addEvent(this.config[t])},addEvent:function(i){var e=this.events,n=e.length,r=new t(i);return e[n]=e,r},removeEvent:function(){return!1},track:function(t){this.mediator.publish("track",t,this)},pageview:function(t){this.mediator.publish("pageview",t,this)}}));var d=!1;"undefined"!=typeof module&&module.exports&&(module.exports=n,d=!0);var y=!1;"function"==typeof define&&define.amd&&(define("Capture",[],function(){return n}),y=!0),d||y||(r.Capture=n)}).call(this);