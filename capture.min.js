/*!
 * Capture 0.0.1
 * (c) 2013 Dan Roberts, Ogilvy & Mather Atlanta
 * Capture may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://eatarandom.github.com/capture/
 */
(function(){"use strict";function t(t){this.cid=f("ce"),u(this,u(s,t)),0>this.id&&(this.id=this.cid),this.initialize.call(this)}function i(){}function e(t,i){this.version=r,!t||"object"==typeof t&&!t.length?i=t:this.config=t,u(this,u(o,i)),this.initialize.call(this)}var n=this,r="0.0.1",o={debug:!1,delay:!1},s={selector:"body",action:"click",type:"track",props:{}},c=[],a=function(){this.debug&&(a.history=a.history||[],a.history.push(arguments),n.console&&console.log(Array.prototype.slice.call(arguments)))},u=function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t},h=0,f=function(t){var i=++h+"";return t?t+i:i},l=Object.keys||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var i=[];for(var e in t)p(t,e)&&(i[i.length]=e);return i},p=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},v=function(t,i){for(var e=0,n=l(t).length;n>e;e++)"function"==typeof t[key]&&(t[key]=t[key].call(i));return t},g=function(){function t(){this.subjects={}}return u(t.prototype,{publish:function(t,i,e){if(this.subjects.hasOwnProperty(t))for(var n=0,r=this.subjects[t].length;r>n;n++){var o=this.subjects[t][n];o.callback.call(e,arguments)}},subscribe:function(t,i){t=""+t,this.subjects.hasOwnProperty(t)||(this.subjects[t]=[]),this.subjects[t].push({context:this,callback:i})}}),{evt:{track:"track",pageview:"pageview"},mediator:new t}}.call(n);u(t.prototype,u(g,{initialize:function(){this.triggerEvent()},triggerEvent:function(){this.mediator.publish(this.type,v(this.props,this),this)}})),u(i.prototype,u(g,{initialize:function(){this.on("track",this.track),this.on("pageview",this.pageview)},track:function(){},pageview:function(){}})),u(e.prototype,u(g,{initialize:function(){if(this.mediator.subscribe("track",this.track),this.mediator.subscribe("pageview",this.pageview),this.config&&this.config.length)for(var t=0,i=this.config.length;i>t;t++)this.addCaptureEvent(this.config[t])},addCaptureEvent:function(i){var e=c,n=e.length,r=new t(i);return e[n]=r,a.call(this,"Added a new CaptureEvent ",r),r},removeCaptureEvent:function(t){for(var i=0,e=c.length;e>i;i++){var n=c[i];if(n.cid===t)return n}return!1},track:function(){},pageview:function(){}}));var d=!1;"undefined"!=typeof module&&module.exports&&(module.exports=e,d=!0);var y=!1;"function"==typeof define&&define.amd&&(define("Capture",[],function(){return e}),y=!0),d||y||(n.Capture=e)}).call(this);